# å­—å…¸APIé›†æˆå®æ–½æ€»ç»“

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1. SharedåŒ…é‡æ„ âœ“

**å˜æ›´å†…å®¹ï¼š**
- âœ… ç§»é™¤æ‰€æœ‰ç¡¬ç¼–ç çš„Labelæ˜ å°„ï¼ˆStatusLabelã€MenuTypeLabelç­‰ï¼‰
- âœ… ç§»é™¤å·¥å…·å‡½æ•°ï¼ˆgetStatusLabelã€getStatusTagTypeç­‰ï¼‰
- âœ… ä¿ç•™å¸¸é‡å€¼æœ¬èº«ï¼ˆStatusã€MenuTypeValueç­‰ï¼‰
- âœ… æ–°å¢å­—å…¸ç±»å‹å¸¸é‡ï¼ˆDictTypes.MENU_VISIBLEï¼‰
- âœ… é‡æ–°æ„å»ºç”ŸæˆES Moduleå’ŒCommonJSåŒæ ¼å¼

**æ–‡ä»¶ä¿®æ”¹ï¼š**
- `packages/shared/src/constants.ts` - ç§»é™¤Labelæ˜ å°„ï¼Œä¿ç•™å¸¸é‡å€¼

### 2. åç«¯APIå®ç° âœ“

**æ–°å¢æ¥å£ï¼š**
```typescript
GET /dict/data/type/:dictType  // æ ¹æ®å­—å…¸ç±»å‹è·å–å­—å…¸æ•°æ®ï¼ˆå…¬å¼€æ¥å£ï¼‰
```

**å®ç°åŠŸèƒ½ï¼š**
- âœ… åˆ›å»º `getDictDataByType` æœåŠ¡æ–¹æ³•
- âœ… åªè¿”å›çŠ¶æ€ä¸ºæ­£å¸¸çš„å­—å…¸æ•°æ®
- âœ… æŒ‰ç…§ dictSort æ’åºè¿”å›
- âœ… è¿”å›å®Œæ•´çš„å­—å…¸æ•°æ®ï¼ˆåŒ…æ‹¬listClassç”¨äºæ ‡ç­¾æ ·å¼ï¼‰

**æ–‡ä»¶ä¿®æ”¹ï¼š**
- `apps/server/src/modules/dict/dict.controller.ts` - æ·»åŠ æ–°æ¥å£
- `apps/server/src/modules/dict/dict.service.ts` - å®ç°æœåŠ¡æ–¹æ³•

### 3. æ•°æ®åº“å­—å…¸åˆå§‹åŒ– âœ“

**æ–°å¢å­—å…¸ç±»å‹ï¼š**
- âœ… sys_user_status - ç”¨æˆ·çŠ¶æ€
- âœ… sys_role_status - è§’è‰²çŠ¶æ€
- âœ… sys_menu_status - èœå•çŠ¶æ€
- âœ… sys_menu_type - èœå•ç±»å‹
- âœ… sys_menu_visible - èœå•å¯è§æ€§
- âœ… sys_dict_status - å­—å…¸çŠ¶æ€
- âœ… sys_yes_no - æ˜¯å¦

**å­—å…¸æ•°æ®ç¤ºä¾‹ï¼š**
```
ç”¨æˆ·çŠ¶æ€ï¼šæ­£å¸¸(1/success)ã€ç¦ç”¨(0/danger)
èœå•ç±»å‹ï¼šç›®å½•(M/warning)ã€èœå•(C/primary)ã€æŒ‰é’®(F/info)
èœå•å¯è§æ€§ï¼šæ˜¾ç¤º(1/success)ã€éšè—(0/info)
```

**æ–‡ä»¶ä¿®æ”¹ï¼š**
- `apps/server/prisma/seed.ts` - æ·»åŠ å®Œæ•´çš„ç³»ç»Ÿå­—å…¸æ•°æ®

### 4. å‰ç«¯å­—å…¸Store âœ“

**å®ç°åŠŸèƒ½ï¼š**
- âœ… å­—å…¸æ•°æ®è‡ªåŠ¨ç¼“å­˜
- âœ… é˜²æ­¢é‡å¤è¯·æ±‚ï¼ˆloadingçŠ¶æ€ç®¡ç†ï¼‰
- âœ… æä¾›å¼ºåˆ¶åˆ·æ–°åŠŸèƒ½
- âœ… æ”¯æŒæ‰¹é‡é¢„åŠ è½½
- âœ… æä¾›ä¾¿æ·çš„æŸ¥è¯¢æ–¹æ³•

**æ ¸å¿ƒæ–¹æ³•ï¼š**
```typescript
getDictData(dictType, forceRefresh)  // è·å–å­—å…¸æ•°æ®ï¼ˆè‡ªåŠ¨ç¼“å­˜ï¼‰
getDictLabel(dictType, value)        // è·å–å­—å…¸æ ‡ç­¾
getDictTagType(dictType, value)      // è·å–æ ‡ç­¾ç±»å‹
clearDictCache(dictType)             // æ¸…é™¤ç¼“å­˜
refreshDict(dictType)                // åˆ·æ–°å­—å…¸
loadDicts(dictTypes[])               // æ‰¹é‡åŠ è½½
```

**æ–°å¢æ–‡ä»¶ï¼š**
- `apps/admin/src/stores/dict.ts` - å­—å…¸Store

### 5. å‰ç«¯Composable âœ“

**å®ç°åŠŸèƒ½ï¼š**
- âœ… ç®€åŒ–å­—å…¸ä½¿ç”¨
- âœ… è‡ªåŠ¨åŠ è½½æ•°æ®
- âœ… æä¾›å“åº”å¼çš„options
- âœ… æä¾›getLabelå’ŒgetTagTypeæ–¹æ³•

**ä½¿ç”¨æ–¹å¼ï¼š**
```typescript
// å•ä¸ªå­—å…¸
const statusDict = useDict(DictTypes.USER_STATUS)
statusDict.getLabel(1)     // "æ­£å¸¸"
statusDict.getTagType(1)   // "success"
statusDict.options.value   // [{label: "æ­£å¸¸", value: "1"}, ...]

// æ‰¹é‡æ“ä½œ
const { getLabel, getTagType, loadDicts } = useDicts()
await loadDicts([DictTypes.USER_STATUS, DictTypes.ROLE_STATUS])
```

**æ–°å¢æ–‡ä»¶ï¼š**
- `apps/admin/src/composables/useDict.ts` - å­—å…¸ç»„åˆå¼å‡½æ•°

### 6. å‰ç«¯é¡µé¢æ›´æ–° âœ“

**æ›´æ–°çš„é¡µé¢ï¼š**
- âœ… `views/home/index.vue` - é¦–é¡µç”¨æˆ·çŠ¶æ€æ˜¾ç¤º
- âœ… `views/system/user/index.vue` - ç”¨æˆ·ç®¡ç†ï¼ˆæŸ¥è¯¢ã€è¡¨æ ¼ã€è¡¨å•ï¼‰
- âœ… `views/system/role/index.vue` - è§’è‰²ç®¡ç†
- âœ… `views/system/menu/index.vue` - èœå•ç®¡ç†ï¼ˆç±»å‹ã€çŠ¶æ€ï¼‰

**æ”¹è¿›æ•ˆæœï¼š**
```vue
<!-- ä¹‹å‰ï¼šç¡¬ç¼–ç  -->
<el-option label="æ­£å¸¸" :value="1" />
<el-option label="ç¦ç”¨" :value="0" />

<el-tag :type="row.status === 1 ? 'success' : 'danger'">
  {{ row.status === 1 ? 'æ­£å¸¸' : 'ç¦ç”¨' }}
</el-tag>

<!-- ç°åœ¨ï¼šä½¿ç”¨å­—å…¸ -->
<el-option 
  v-for="item in statusDict.options.value"
  :key="item.value"
  :label="item.label" 
  :value="Number(item.value)" 
/>

<el-tag :type="statusDict.getTagType(row.status)">
  {{ statusDict.getLabel(row.status) }}
</el-tag>
```

### 7. APIæ¥å£æ›´æ–° âœ“

**æ–°å¢æ–¹æ³•ï¼š**
```typescript
export function getDictDataByType(dictType: string): Promise<DictData[]> {
  return request({
    url: `/dict/data/type/${dictType}`,
    method: 'get'
  })
}
```

**æ–‡ä»¶ä¿®æ”¹ï¼š**
- `apps/admin/src/api/dict.ts` - æ·»åŠ å­—å…¸æ•°æ®è·å–æ¥å£

## ğŸ“Š æŠ€æœ¯æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      æ•°æ®åº“å±‚                             â”‚
â”‚  - dictè¡¨ï¼ˆå­—å…¸ç±»å‹ï¼‰                                      â”‚
â”‚  - dict_dataè¡¨ï¼ˆå­—å…¸æ•°æ®ï¼ŒåŒ…å«labelå’ŒlistClassï¼‰           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      åç«¯APIå±‚                            â”‚
â”‚  GET /dict/data/type/:dictType                          â”‚
â”‚  - æŸ¥è¯¢æ­£å¸¸çŠ¶æ€çš„å­—å…¸æ•°æ®                                   â”‚
â”‚  - æŒ‰dictSortæ’åº                                        â”‚
â”‚  - è¿”å›labelã€valueã€listClassç­‰                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     å‰ç«¯Storeå±‚                           â”‚
â”‚  useDictStore                                           â”‚
â”‚  - Mapç¼“å­˜: dictCache                                   â”‚
â”‚  - é˜²é‡å¤è¯·æ±‚: loadingCache                              â”‚
â”‚  - è‡ªåŠ¨ç¼“å­˜æœºåˆ¶                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   å‰ç«¯Composableå±‚                        â”‚
â”‚  useDict(dictType)                                      â”‚
â”‚  - è‡ªåŠ¨åŠ è½½å­—å…¸                                           â”‚
â”‚  - æä¾›getLabelã€getTagType                             â”‚
â”‚  - æä¾›å“åº”å¼options                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Vueç»„ä»¶å±‚                             â”‚
â”‚  - ä½¿ç”¨statusDict.getLabel()                            â”‚
â”‚  - ä½¿ç”¨statusDict.getTagType()                          â”‚
â”‚  - ä½¿ç”¨statusDict.options.value                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¯ æ ¸å¿ƒä¼˜åŠ¿

### 1. åŠ¨æ€é…ç½®
- âœ… å­—å…¸æ•°æ®å­˜å‚¨åœ¨æ•°æ®åº“
- âœ… ä¿®æ”¹å­—å…¸æ— éœ€é‡æ–°ç¼–è¯‘
- âœ… æ”¯æŒè¿è¡Œæ—¶æ›´æ–°

### 2. æ€§èƒ½ä¼˜åŒ–
- âœ… é¦–æ¬¡åŠ è½½åè‡ªåŠ¨ç¼“å­˜
- âœ… é¿å…é‡å¤è¯·æ±‚
- âœ… æ”¯æŒæ‰¹é‡é¢„åŠ è½½
- âœ… é˜²æ­¢å¹¶å‘è¯·æ±‚

### 3. æ˜“äºç»´æŠ¤
- âœ… ç»Ÿä¸€çš„å­—å…¸ç®¡ç†
- âœ… ç®€å•çš„ä½¿ç”¨æ–¹å¼
- âœ… æ¸…æ™°çš„æ•°æ®ç»“æ„

### 4. æ‰©å±•æ€§å¼º
- âœ… è½»æ¾æ·»åŠ æ–°å­—å…¸
- âœ… çµæ´»çš„å­—å…¸é…ç½®
- âœ… æ”¯æŒè‡ªå®šä¹‰æ ·å¼

## ğŸ“ ä½¿ç”¨ç¤ºä¾‹

### åŸºç¡€ä½¿ç”¨
```vue
<script setup lang="ts">
import { DictTypes } from '@admin-system/shared'
import { useDict } from '@/composables/useDict'

// ä½¿ç”¨å­—å…¸
const statusDict = useDict(DictTypes.USER_STATUS)
</script>

<template>
  <!-- ä¸‹æ‹‰é€‰æ‹© -->
  <el-select v-model="form.status">
    <el-option 
      v-for="item in statusDict.options.value"
      :key="item.value"
      :label="item.label" 
      :value="Number(item.value)" 
    />
  </el-select>
  
  <!-- æ˜¾ç¤ºæ ‡ç­¾ -->
  <el-tag :type="statusDict.getTagType(user.status)">
    {{ statusDict.getLabel(user.status) }}
  </el-tag>
</template>
```

### æ‰¹é‡é¢„åŠ è½½
```vue
<script setup lang="ts">
import { onMounted } from 'vue'
import { DictTypes } from '@admin-system/shared'
import { useDicts } from '@/composables/useDict'

const { loadDicts } = useDicts()

onMounted(async () => {
  // é¢„åŠ è½½å¤šä¸ªå­—å…¸
  await loadDicts([
    DictTypes.USER_STATUS,
    DictTypes.ROLE_STATUS,
    DictTypes.MENU_TYPE,
  ])
})
</script>
```

### å¼ºåˆ¶åˆ·æ–°
```typescript
import { useDictStore } from '@/stores/dict'

const dictStore = useDictStore()

// åˆ·æ–°æŒ‡å®šå­—å…¸
await dictStore.refreshDict('sys_user_status')

// æ¸…é™¤æ‰€æœ‰ç¼“å­˜
dictStore.clearDictCache()
```

## ğŸ”„ ç¼“å­˜æœºåˆ¶

### ç¼“å­˜æµç¨‹
```
1. ç»„ä»¶è°ƒç”¨ useDict(dictType)
   â†“
2. æ£€æŸ¥ç¼“å­˜ dictCache.has(dictType)?
   â”œâ”€ æœ‰ç¼“å­˜ â†’ ç›´æ¥è¿”å›
   â””â”€ æ— ç¼“å­˜ â†“
3. æ£€æŸ¥æ˜¯å¦æ­£åœ¨åŠ è½½ loadingCache.get(dictType)?
   â”œâ”€ æ­£åœ¨åŠ è½½ â†’ ç­‰å¾…åŠ è½½å®Œæˆ
   â””â”€ æœªåŠ è½½ â†“
4. è®¾ç½®åŠ è½½çŠ¶æ€ loadingCache.set(dictType, true)
   â†“
5. è°ƒç”¨API getDictDataByType(dictType)
   â†“
6. ä¿å­˜åˆ°ç¼“å­˜ dictCache.set(dictType, data)
   â†“
7. æ¸…é™¤åŠ è½½çŠ¶æ€ loadingCache.set(dictType, false)
   â†“
8. è¿”å›æ•°æ®
```

### ç¼“å­˜ç‰¹ç‚¹
- âœ… **è‡ªåŠ¨ç¼“å­˜**ï¼šé¦–æ¬¡åŠ è½½åè‡ªåŠ¨ä¿å­˜
- âœ… **é¿å…é‡å¤**ï¼šåŒä¸€å­—å…¸ä¸ä¼šé‡å¤è¯·æ±‚
- âœ… **å¹¶å‘å®‰å…¨**ï¼šé˜²æ­¢åŒæ—¶å‘èµ·å¤šä¸ªç›¸åŒè¯·æ±‚
- âœ… **å¼ºåˆ¶åˆ·æ–°**ï¼šæ”¯æŒæ‰‹åŠ¨åˆ·æ–°ç¼“å­˜
- âœ… **é€‰æ‹©æ¸…é™¤**ï¼šå¯æ¸…é™¤æŒ‡å®šå­—å…¸æˆ–å…¨éƒ¨ç¼“å­˜

## ğŸ“¦ æ„å»ºç»“æœ

### å‰ç«¯æ„å»º âœ“
```bash
âœ“ 1551 modules transformed
âœ“ built in 3.85s
```

### åç«¯æ„å»º âœ“
```bash
âœ“ nest build completed
```

### SharedåŒ…æ„å»º âœ“
```bash
âœ“ CommonJS and ES Module generated
```

## ğŸ“š æ–‡æ¡£

åˆ›å»ºçš„æ–‡æ¡£æ–‡ä»¶ï¼š
- âœ… `DICT_API_INTEGRATION.md` - å­—å…¸APIé›†æˆè¯¦ç»†è¯´æ˜
- âœ… `IMPLEMENTATION_SUMMARY.md` - å®æ–½æ€»ç»“ï¼ˆæœ¬æ–‡ä»¶ï¼‰

## ğŸ‰ æ€»ç»“

é€šè¿‡æœ¬æ¬¡é‡æ„ï¼Œæˆ‘ä»¬å®ç°äº†ï¼š

1. **ä»ç¡¬ç¼–ç åˆ°åŠ¨æ€é…ç½®**
   - å­—å…¸æ•°æ®ä»ä»£ç ä¸­ç§»åˆ°æ•°æ®åº“
   - æ”¯æŒè¿è¡Œæ—¶ä¿®æ”¹ï¼Œæ— éœ€é‡æ–°ç¼–è¯‘

2. **ä»æ‰‹åŠ¨ç®¡ç†åˆ°è‡ªåŠ¨ç¼“å­˜**
   - è‡ªåŠ¨ç¼“å­˜æœºåˆ¶
   - é˜²æ­¢é‡å¤è¯·æ±‚
   - æå‡æ€§èƒ½

3. **ä»åˆ†æ•£ä½¿ç”¨åˆ°ç»Ÿä¸€ç®¡ç†**
   - ç»Ÿä¸€çš„å­—å…¸Store
   - ç®€åŒ–çš„Composable
   - ä¸€è‡´çš„ä½¿ç”¨æ–¹å¼

4. **æ›´å¥½çš„ç”¨æˆ·ä½“éªŒ**
   - é¦–æ¬¡åŠ è½½åå³å¯ç¦»çº¿ä½¿ç”¨
   - æ”¯æŒæ‰¹é‡é¢„åŠ è½½
   - å‡å°‘APIè¯·æ±‚æ¬¡æ•°

æ‰€æœ‰åŠŸèƒ½å·²å®ç°å¹¶æµ‹è¯•é€šè¿‡ï¼ğŸš€

